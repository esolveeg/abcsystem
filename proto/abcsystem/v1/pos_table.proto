syntax = "proto3";

package abcsystem.v1;

import "buf/validate/validate.proto";

message TableRow {
  string table_name = 1 [(buf.validate.field).string = {min_len: 1, max_len: 128}];
  int32  no_of_seats = 2 [(buf.validate.field).int32  = {gte: 0, lte: 10000}];
  string location = 3 [(buf.validate.field).string = {min_len: 0, max_len: 128}];
}

message Order {
  string customer     = 1 [(buf.validate.field).string = {min_len: 0, max_len: 256}];
  double grand_total  = 2 [(buf.validate.field).double = {gte: 0}];
  string posting_date = 3 [(buf.validate.field).string = {
    pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    max_len: 10
  }];
  string posting_time = 4 [(buf.validate.field).string = {
    pattern: "^[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?$"
    max_len: 15
  }];
}

message TableOrdersRow {
  repeated Order orders = 2 ;
  double total = 3 [(buf.validate.field).double = {gte: 0}];
}
message TableListRequest {
  string restaurant_id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 128}];
}

message TableListResponse {
  repeated TableRow rows = 1 ;
}

message TableOrdersRequest {
  string restaurant_id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 128}];
}

message TableOrdersResponse {
map<string, TableOrdersRow> tables = 1;
}

